<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <meta name="description" content="POS - Bootstrap Admin Template">
    <meta name="keywords" content="admin, estimates, bootstrap, business, corporate, creative, management, minimal, modern,  html5, responsive">
    <meta name="author" content="Dreamguys - Bootstrap Admin Template">
    <meta name="robots" content="noindex, nofollow">
    <title>Dreams Note Days</title>
    <link rel="shortcut icon" type="image/x-icon" href="../assets/img/favicon.jpg">
    <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/css/animate.css">
    <link rel="stylesheet" href="../assets/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="../assets/plugins/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="../assets/plugins/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/style.css">

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"> -->
    <style>
        #fokus{            
                color: #ff9f43;             
            }            
        .calendar-container {
        max-width: 500px;
        margin: 30px auto;
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        padding: 20px;
        }
        .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
        }
        .calendar-title {
        font-size: 1.2rem;
        font-weight: bold;
        }
        .current-date {
        text-align: center;
        font-size: 1rem;
        font-weight: 500;
        margin-bottom: 5px;
        color: #555;
        }
        .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
        }
        .day-header {
        text-align: center;
        font-weight: 600;
        background-color: #f8f9fa;
        padding: 6px;
        font-size: 0.9rem;
        border-radius: 6px;
        }
        .day-cell {
        text-align: center;
        padding: 10px 0;
        border-radius: 6px;
        font-size: 0.95rem;
        transition: background-color 0.2s;
        }
        .day-cell:hover {
        background-color: #f2f2f2;
        }
        .highlight-bg {
        background-color: orange !important;
        color: white;
        font-weight: bold;
        }
        button.nav-btn {
        background-color: transparent;
        border: none;
        font-size: 1.3rem;
        }
  </style>
</head>



<body>
    <div id="global-loader">
        <div class="whirly-loader"></div>
    </div>
    <div class="main-wrapper">
        <div class="header">
            <div class="header-left active">
                <div class="logo d-none d-md-block">
                    <a href="index.html">
                        <img src="../assets/img/logo.png" alt="">
                    </a>
                </div>                
                
                <a href="index.html" class="logo-small">
                    <img src="../assets/img/logo-small.png" alt="">
                </a>
                <a id="toggle_btn" href="javascript:void(0);"></a>
            </div>
            <a id="mobile_btn" class="mobile_btn" href="#sidebar">
                <span class="bar-icon">
                    <span></span>
                    <span></span>
                    <span></span>
                </span>
            </a>
            <ul class="nav user-menu">
                <li class="nav-item">
                    <div class="top-nav-search">
                        <a href="javascript:void(0);" class="responsive-search">
                            <i class="fa fa-search"></i>
                        </a>
                        <form action="#">
                            <div class="searchinputs">
                                <input type="text" placeholder="Search Here ...">
                                <div class="search-addon">
                                    <span>
                                        <img src="../assets/img/icons/closes.svg" alt="img">
                                    </span>
                                </div>
                            </div>
                            <a class="btn" id="searchdiv">
                                <img src="../assets/img/icons/search.svg" alt="img">
                            </a>
                        </form>
                    </div>
                </li>
                <li class="nav-item dropdown has-arrow flag-nav">
                    <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="javascript:void(0);" role="button">
                        <img src="../assets/img/flags/us1.png" alt="" height="20">
                    </a>
                    <div class="dropdown-menu dropdown-menu-right">
                        <a href="javascript:void(0);" class="dropdown-item">
                            <img src="../assets/img/flags/us.png" alt="" height="16"> English </a>
                        <a href="javascript:void(0);" class="dropdown-item">
                            <img src="../assets/img/flags/fr.png" alt="" height="16"> French </a>
                        <a href="javascript:void(0);" class="dropdown-item">
                            <img src="../assets/img/flags/es.png" alt="" height="16"> Spanish </a>
                        <a href="javascript:void(0);" class="dropdown-item">
                            <img src="../assets/img/flags/de.png" alt="" height="16"> German </a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a href="javascript:void(0);" class="dropdown-toggle nav-link" data-bs-toggle="dropdown">
                        <img src="../assets/img/icons/notification-bing.svg" alt="img">
                        <span class="badge rounded-pill">4</span>
                    </a>
                    <div class="dropdown-menu notifications">
                        <div class="topnav-dropdown-header">
                            <span class="notification-title">Notifications</span>
                            <a href="javascript:void(0)" class="clear-noti"> Clear All </a>
                        </div>
                        <div class="noti-content">
                            <ul class="notification-list">
                                <li class="notification-message">
                                    <a href="activities.html">
                                        <div class="media d-flex">
                                            <span class="avatar flex-shrink-0">
                                                <img alt="" src="../assets/img/profiles/avatar-02.jpg">
                                            </span>
                                            <div class="media-body flex-grow-1">
                                                <p class="noti-details">
                                                    <span class="noti-title">John Doe</span> added new task <span class="noti-title">Patient appointment booking</span>
                                                </p>
                                                <p class="noti-time">
                                                    <span class="notification-time">4 mins ago</span>
                                                </p>
                                            </div>
                                        </div>
                                    </a>
                                </li>
                                <li class="notification-message">
                                    <a href="activities.html">
                                        <div class="media d-flex">
                                            <span class="avatar flex-shrink-0">
                                                <img alt="" src="../assets/img/profiles/avatar-03.jpg">
                                            </span>
                                            <div class="media-body flex-grow-1">
                                                <p class="noti-details">
                                                    <span class="noti-title">Tarah Shropshire</span> changed the task name <span class="noti-title">Appointment booking with payment gateway</span>
                                                </p>
                                                <p class="noti-time">
                                                    <span class="notification-time">6 mins ago</span>
                                                </p>
                                            </div>
                                        </div>
                                    </a>
                                </li>
                                <li class="notification-message">
                                    <a href="activities.html">
                                        <div class="media d-flex">
                                            <span class="avatar flex-shrink-0">
                                                <img alt="" src="../assets/img/profiles/avatar-06.jpg">
                                            </span>
                                            <div class="media-body flex-grow-1">
                                                <p class="noti-details">
                                                    <span class="noti-title">Misty Tison</span> added <span class="noti-title">Domenic Houston</span> and <span class="noti-title">Claire Mapes</span> to project <span class="noti-title">Doctor available module</span>
                                                </p>
                                                <p class="noti-time">
                                                    <span class="notification-time">8 mins ago</span>
                                                </p>
                                            </div>
                                        </div>
                                    </a>
                                </li>
                                <li class="notification-message">
                                    <a href="activities.html">
                                        <div class="media d-flex">
                                            <span class="avatar flex-shrink-0">
                                                <img alt="" src="../assets/img/profiles/avatar-17.jpg">
                                            </span>
                                            <div class="media-body flex-grow-1">
                                                <p class="noti-details">
                                                    <span class="noti-title">Rolland Webber</span> completed task <span class="noti-title">Patient and Doctor video conferencing</span>
                                                </p>
                                                <p class="noti-time">
                                                    <span class="notification-time">12 mins ago</span>
                                                </p>
                                            </div>
                                        </div>
                                    </a>
                                </li>
                                <li class="notification-message">
                                    <a href="activities.html">
                                        <div class="media d-flex">
                                            <span class="avatar flex-shrink-0">
                                                <img alt="" src="../assets/img/profiles/avatar-13.jpg">
                                            </span>
                                            <div class="media-body flex-grow-1">
                                                <p class="noti-details">
                                                    <span class="noti-title">Bernardo Galaviz</span> added new task <span class="noti-title">Private chat module</span>
                                                </p>
                                                <p class="noti-time">
                                                    <span class="notification-time">2 days ago</span>
                                                </p>
                                            </div>
                                        </div>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="topnav-dropdown-footer">
                            <a href="activities.html">View all Notifications</a>
                        </div>
                    </div>
                </li>
                <li class="nav-item dropdown has-arrow main-drop">
                    <a href="javascript:void(0);" class="dropdown-toggle nav-link userset" data-bs-toggle="dropdown">
                        <span class="user-img">
                            <img src="../assets/img/profiles/avator1.jpg" alt="">
                            <span class="status online"></span>
                        </span>
                    </a>
                    <div class="dropdown-menu menu-drop-user">
                        <div class="profilename">
                            <div class="profileset">
                                <span class="user-img">
                                    <img src="../assets/img/profiles/avator1.jpg" alt="">
                                    <span class="status online"></span>
                                </span>
                                <div class="profilesets">
                                    <h6>John Doe</h6>
                                    <h5>Admin</h5>
                                </div>
                            </div>
                            <hr class="m-0">
                            <a class="dropdown-item" href="profile.html">
                                <i class="me-2" data-feather="user"></i> My Profile </a>
                            <a class="dropdown-item" href="generalsettings.html">
                                <i class="me-2" data-feather="settings"></i>Settings </a>
                            <hr class="m-0">
                            <a class="dropdown-item logout pb-0" href="signin.html">
                                <img src="../assets/img/icons/log-out.svg" class="me-2" alt="img">Logout </a>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="dropdown mobile-user-menu">
                <a href="javascript:void(0);" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fa fa-ellipsis-v"></i>
                </a>
                <div class="dropdown-menu dropdown-menu-right">
                    <a class="dropdown-item" href="profile.html">My Profile</a>
                    <a class="dropdown-item" href="generalsettings.html">Settings</a>
                    <a class="dropdown-item" href="signin.html">Logout</a>
                </div>
            </div>
        </div>
        <div class="sidebar" id="sidebar">
            <div class="sidebar-inner slimscroll">
                <div id="sidebar-menu" class="sidebar-menu">
                    <ul>
                        <li>
                            <a href="../dashboard.html">
                                <span> Dashboard</span>
                            </a>
                        </li>
                        <li class="submenu">
                            <a href="javascript:void(0);">                                
                                <span> Create Note</span>
                                <span class="menu-arrow"></span>
                            </a>
                            <ul>
                                <li>
                                    <a href="content/create.html">Create Note</a>
                                </li>
                                <li>
                                    <a href="content/category.html">Create Category</a>
                                </li>                                
                            </ul>
                        </li>
                        <li class="submenu">
                            <a href="javascript:void(0);">                                
                                <span> Show Note</span>
                                <span class="menu-arrow"></span>
                            </a>
                            <ul>
                                <li>
                                    <a href="content/show.html">Today's Expense Notes</a>
                                </li>    
                                <li>
                                    <a href="content/noteAll.html">Expense Records all</a>
                                </li>
                                                            
                            </ul>
                        </li>    
                        <li class="bg-secondary rounded">
                            <a href="coin.html">                                
                                <span class="text-white"> Coin</span>
                            </a>
                        </li>                    
                    </ul>
                </div>
            </div>
        </div>
        <div class="page-wrapper">
            <div class="content">
                <div class="row justify-content-center">
                    <div class="col-md-6 col-lg-5">
                      <h6 class="text-center h3 mb-2" id="todayText">Hari ini</h6>
                      <div class="card shadow border-0 rounded-4">
                        <div class="card-body p-4">
                          <div class="calendar-header d-flex justify-content-between align-items-center mb-3">
                            <button class="nav-btn" id="prevMonth">&laquo;</button>
                            <h5 class="calendar-title m-0 fw-semibold" id="calendarTitle">Kalender</h5>
                            <button class="nav-btn" id="nextMonth">&raquo;</button>
                          </div>
                          <div class="calendar-grid" id="calendarGrid"></div>
                        </div>
                      </div>
                      <div class="d-flex justify-content-center">
                        <button id="test" class="btn mt-2 fw-semibold text-white">Tes Apakah Ada Data Hari Ini</button>
                      </div>
                    </div>
                  </div>
            </div>
        </div>
    </div>
    <script src="../assets/js/jquery-3.6.0.min.js"></script>
    <script src="../assets/js/feather.min.js"></script>
    <script src="../assets/js/jquery.slimscroll.min.js"></script>
    <script src="../assets/js/jquery.dataTables.min.js"></script>
    <script src="../assets/js/dataTables.bootstrap4.min.js"></script>
    <script src="../assets/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/plugins/apexchart/apexcharts.min.js"></script>
    <script src="../assets/plugins/apexchart/chart-data.js"></script>
    <script src="../assets/js/script.js"></script>
    
    <script>
        function initCalendar() {
          const monthNames = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
          const weekdays = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
          let currentDate = new Date();
          let targetDates = [];
    
          function renderTodayText() {
            const today = new Date();
            const dayName = weekdays[today.getDay()];
            const day = today.getDate();
            const month = monthNames[today.getMonth()];
            const year = today.getFullYear();
            $('#todayText').text(`${dayName}, ${day} ${month} ${year}`);
          }
    
          function renderCalendar(date) {
            const year = date.getFullYear();
            const month = date.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const totalDays = new Date(year, month + 1, 0).getDate();
    
            $('#calendarTitle').text(`${monthNames[month]} ${year}`);
            const grid = $('#calendarGrid');
            grid.empty();
    
            ['Min', 'Sen', 'Sel', 'Rab', 'Kam', 'Jum', 'Sab'].forEach(day => {
              grid.append(`<div class="day-header">${day}</div>`);
            });
    
            for (let i = 0; i < firstDay; i++) {
              grid.append(`<div></div>`);
            }
    
            for (let d = 1; d <= totalDays; d++) {
              const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
              const isHighlight = targetDates.includes(dateStr);
              const className = isHighlight ? 'day-cell highlight-bg' : 'day-cell';
              grid.append(`<div class="${className}">${d}</div>`);
            }
          }
    
          function fetchDatesFromFirebase() {
            $.ajax({
                url: 'https://catatan-harian-bcc18-default-rtdb.asia-southeast1.firebasedatabase.app/Coin.json',
                method: 'GET',
                success: function(data) {
                if (data) {
                    targetDates = Object.values(data).map(item => item.date);
                } else {
                    targetDates = [];
                }
                    renderCalendar(currentDate); // selalu render kalender
                },
                error: function(err) {
                    console.error('❌ Gagal mengambil data dari Firebase:', err);
                    targetDates = [];
                    renderCalendar(currentDate);
                }
            });
        }
    
    
          function checkTodayInFirebase() {
            const today = new Date();
            const todayStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
    
            $.ajax({
              url: 'https://catatan-harian-bcc18-default-rtdb.asia-southeast1.firebasedatabase.app/Coin.json',
              method: 'GET',
              success: function(data) {
                const todayStr = new Date(new Date().getTime() + (7 * 60 * 60 * 1000)).toISOString().slice(0, 10);
                const $btn = $('#test');
    
                if (data) {
                    const exists = Object.values(data).some(item => item.date === todayStr);
                    if (exists) {
                    $btn
                        .attr('disabled', true)
                        .removeClass('btn-primary')
                        .addClass('btn-secondary')
                        .text('Anda Sudah Melakukan Misi');
                    } else {
                    $btn
                        .attr('disabled', false)
                        .removeClass('btn-secondary')
                        .addClass('btn-primary')
                        .text('Anda Belum Melakukan Misi');
                    }
                } else {
                    // data kosong, tetap tampilkan tombol
                    $btn
                    .attr('disabled', false)
                    .removeClass('btn-secondary')
                    .addClass('btn-primary')
                    .text('Anda Belum Melakukan Misi');
                }
              },
              error: function(err) {
                console.error('❌ Gagal mengecek data hari ini:', err);
              }
            });
          }
    
          function goToPrevMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar(currentDate);
          }
    
          function goToNextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar(currentDate);
          }
    
          // Inisialisasi saat halaman siap
          $(document).ready(() => {
            renderTodayText();
            fetchDatesFromFirebase();
            checkTodayInFirebase();
            $('#prevMonth').click(goToPrevMonth);
            $('#nextMonth').click(goToNextMonth);
          });
        }
    
        // Confirm
        $('#test').on('click', function () {
        Swal.fire({
          title: 'Tambah data baru?',
          text: "Data akan disimpan ke dalam sistem!",
          icon: 'question',
          showCancelButton: true,
          confirmButtonColor: '#0d6efd',
          cancelButtonColor: '#6c757d',
          confirmButtonText: 'Ya, tambah!',
          cancelButtonText: 'Batal'
        }).then((result) => {
          if (result.isConfirmed) {
                    
            $.ajax({
                url: 'https://catatan-harian-bcc18-default-rtdb.asia-southeast1.firebasedatabase.app/Coin.json',
                method: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({
                    // date: "2025-07-10",  
                    date: new Date(new Date().getTime() + (7 * 60 * 60 * 1000)).toISOString().slice(0, 10),
                    koin: 4000
                }),
                success: function (res) {
                    Swal.fire({
                        title: 'Berhasil!',
                        text: 'Data berhasil ditambahkan.',
                        icon: 'success',
                        confirmButtonText: 'OK'
                    }).then(() => {
                        location.reload();
                    });
                },
                error: function (err) {
                    Swal.fire('Gagal!', 'Terjadi kesalahan.', 'error');
                    console.error(err);
                }
            });
    
            
          }
        });
      });
    
    
        // Jalankan
        initCalendar();
      </script>

    
</body>

</html>
